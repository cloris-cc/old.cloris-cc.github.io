<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>docker - 茶茶日记 - winklog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="茶茶日记 - winklog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="茶茶日记 - winklog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="…"><meta property="og:type" content="blog"><meta property="og:title" content="docker"><meta property="og:url" content="https://teamwang.cn/2021/10/29/docker/"><meta property="og:site_name" content="茶茶日记 - winklog"><meta property="og:description" content="…"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/image-20211028175926370.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/RGSWSx.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/UhmYvt.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/Y0in7t.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/JXW8MC.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/bz4T6c.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/Kxzur3.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/LHQjDu.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/E2d7qr.png"><meta property="og:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/KjIZEB.png"><meta property="article:published_time" content="2021-10-29T08:27:21.000Z"><meta property="article:modified_time" content="2021-11-02T17:34:19.462Z"><meta property="article:author" content="Jacky"><meta property="article:tag" content="茶茶,日记,茶茶日记,winklog,WinkLog,博客,teamwang,TeamWang,王嘉尔,Jakcy,jacky"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://gitee.com/jacky_cloud/oss/raw/master/uPic/image-20211028175926370.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://teamwang.cn/2021/10/29/docker/"},"headline":"docker","image":["https://gitee.com/jacky_cloud/oss/raw/master/uPic/image-20211028175926370.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/RGSWSx.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/UhmYvt.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/Y0in7t.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/JXW8MC.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/bz4T6c.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/Kxzur3.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/LHQjDu.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/E2d7qr.png","https://gitee.com/jacky_cloud/oss/raw/master/uPic/KjIZEB.png"],"datePublished":"2021-10-29T08:27:21.000Z","dateModified":"2021-11-02T17:34:19.462Z","author":{"@type":"Person","name":"Jacky"},"description":"…"}</script><link rel="canonical" href="https://teamwang.cn/2021/10/29/docker/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?05af3f3bd18ffe652b63cc7ee6abb48c";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="茶茶日记 - winklog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">时光轴</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-10-29T08:27:21.000Z" title="10/29/2021, 4:27:21 PM">2021-10-29</time>发表</span><span class="level-item"><time dateTime="2021-11-02T17:34:19.462Z" title="11/3/2021, 1:34:19 AM">2021-11-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/DevOps/">DevOps</a></span><span class="level-item">16 分钟读完 (大约2325个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">docker</h1><div class="content"><p>…</p>
<span id="more"></span>

<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>3306(<strong>本机</strong>)<code>:</code>3306(容器)</p>
<ul>
<li>docker run hello-world(image)</li>
<li>docker run –help</li>
<li>docker start [容器id]</li>
<li>docker image ls</li>
<li>docker container ls （运行中）</li>
<li>docker container ls –all</li>
<li>docker container stop [name]</li>
<li>docker container rm webserver</li>
<li>docker rmi [iamge]</li>
<li>docker stats</li>
<li>docker network/volume crate/ls/rm</li>
<li>docker inspect [image/container/network/volume]</li>
</ul>
<h2 id="命令的使用"><a href="#命令的使用" class="headerlink" title="命令的使用"></a>命令的使用</h2><h3 id="run-新容器"><a href="#run-新容器" class="headerlink" title="run 新容器"></a>run 新容器</h3><p><code>docker run -p 6379:6379 -d redis:latest redis-server</code></p>
<p><code>docker run --name test-mysql -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456. mysql</code></p>
<h3 id="打开mysql-client命令行"><a href="#打开mysql-client命令行" class="headerlink" title="打开mysql client命令行"></a>打开mysql client命令行</h3><p><code>docker run -it --rm mysql mysql -h47.94.128.66 -uroot -p</code></p>
<h3 id="查看容器信息"><a href="#查看容器信息" class="headerlink" title="查看容器信息"></a>查看容器信息</h3><p>docker inspect [容器id]</p>
<h3 id="进入容器路径"><a href="#进入容器路径" class="headerlink" title="进入容器路径"></a>进入容器路径</h3><p>docker exec -it [容器id] [/bin/bash]</p>
<p>docker exec –help</p>
<h3 id="路径映射"><a href="#路径映射" class="headerlink" title="路径映射"></a>路径映射</h3><p>docker -v</p>
<p><code>docker run -d -p 8888:8888 -v C:/all/server/nginx-config/nginx.conf:/etc/nginx/nginx.conf:ro nginx</code></p>
<p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/image-20211028175926370.png" alt="image-20211028175926370"></p>
<p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/RGSWSx.png" alt="RGSWSx"></p>
<h3 id="build-构建镜像"><a href="#build-构建镜像" class="headerlink" title="build 构建镜像"></a>build 构建镜像</h3><ol>
<li><p>cd 当前目录：<br><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/UhmYvt.png" alt="UhmYvt"></p>
</li>
<li><p>执行命令：<br><code>docker build -t jackyofteamwang/cheers2019 .</code><br>其中，jackyofteamwang/cheers2019 为镜像文件</p>
</li>
<li><p>推送：<br><code>docker login</code></p>
</li>
</ol>
<p><code>docker push jackyofteamwang/cheers2019</code></p>
<h3 id="删除-docker"><a href="#删除-docker" class="headerlink" title="删除 docker"></a>删除 docker</h3><p>除了官网的方法：</p>
<p>查询相关软件包<br>dpkg -l|grep docker</p>
<p>sudo apt remove -purge dock.io</p>
<h3 id="查看镜像信息"><a href="#查看镜像信息" class="headerlink" title="查看镜像信息"></a>查看镜像信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect rancher&#x2F;rancher:latest</span><br></pre></td></tr></table></figure>

<h3 id="容器间的网络通信"><a href="#容器间的网络通信" class="headerlink" title="容器间的网络通信"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38403662/article/details/102555888?utm_medium=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase&depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-1.nonecase">容器间的网络通信</a></h3><p>(<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhizhuodewo6/article/details/87706638">https://blog.csdn.net/zhizhuodewo6/article/details/87706638</a>)</p>
<p>Docker有以下网络类型：</p>
<ul>
<li>  bridge：多由于独立container之间的通信</li>
<li>  host： 直接使用宿主机的网络，端口也使用宿主机的</li>
<li>  overlay：当有多个docker主机时，跨主机的container通信</li>
<li>  macvlan：每个container都有一个虚拟的MAC地址</li>
<li>  none: 禁用网络</li>
</ul>
<h4 id="使用docker命令"><a href="#使用docker命令" class="headerlink" title="使用docker命令"></a>使用docker命令</h4><ol>
<li>创建 bridge 网络</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create --driver bridge local-net</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>容器启动时指定<code>--network [your net]</code>和<code>--name [your name]</code></li>
</ol>
<p>这样，就可以在容器内<code>ping [container_name]</code>同个bridge的容器。</p>
<h4 id="使用-docker-compose"><a href="#使用-docker-compose" class="headerlink" title="使用 docker-compose"></a>使用 docker-compose</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">some-network:</span></span><br><span class="line">    <span class="comment"># Use a custom driver</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">custom-driver-1</span></span><br><span class="line">  <span class="attr">other-network:</span></span><br><span class="line">    <span class="comment"># Use a custom driver which takes special options</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">custom-driver-2</span></span><br></pre></td></tr></table></figure>

<h2 id="Docker-构建-SpringBoot-应用"><a href="#Docker-构建-SpringBoot-应用" class="headerlink" title="Docker 构建 SpringBoot 应用"></a>Docker 构建 SpringBoot 应用</h2><h3 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h3><p>使用命令：<code>docker build -t jackyfangofteamwang/app.jar .</code></p>
<p><code>Dockerfile</code> 文件如下：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">FROM</span> <span class="string">openjdk:8</span></span><br><span class="line"></span><br><span class="line"><span class="string">MAINTAINER</span> <span class="string">jakcy</span> <span class="string">&quot;jacky.teamwang@qq.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">ENV</span> <span class="string">TZ=&quot;Asia/Shanghai&quot;</span></span><br><span class="line"><span class="string">VOLUME</span> <span class="string">/tmp</span></span><br><span class="line"><span class="string">ADD</span> <span class="string">tea-tea.jar</span> <span class="string">app.jar</span></span><br><span class="line"><span class="comment"># docker hints server port</span></span><br><span class="line"><span class="string">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="string">ENTRYPOINT</span> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;app.jar&quot;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>挂载日志目录：</p>
<p><code>docker run -d -p 8085:8085 -v C:/all/volume/tmp:/tmp jackyfangofteamwang/chaos.jar</code></p>
<h3 id="docker-compose-构建运行"><a href="#docker-compose-构建运行" class="headerlink" title="docker-compose 构建运行"></a>docker-compose 构建运行</h3><p>docker-compose 实际上是 docker run 的命令封装。</p>
<p><code>docker-compose.yml</code> 文件如下：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2.2&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">demo:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">jackyfangofteamwang/app.jar:1.0.0</span></span><br><span class="line">    <span class="comment"># 本机端口号:docker端口</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8083</span><span class="string">:8083</span></span><br></pre></td></tr></table></figure>

<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>docker 的时区问题-启动容器时指定参数:<code>-e TZ=&quot;Asia/Shanghai&quot;</code></li>
<li>docker 可以使用 localhost，但是需要做端口映射（即还是使用主机端口）。</li>
</ul>
<h1 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h1><p>启动命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">  -u root \</span><br><span class="line">  -d \</span><br><span class="line">  -p 18080:8080 \</span><br><span class="line">  -p 50000:50000 \</span><br><span class="line">  -v &#x2F;jacky&#x2F;data&#x2F;docker&#x2F;jenkins-data:&#x2F;var&#x2F;jenkins_home \</span><br><span class="line">  -v &#x2F;jacky&#x2F;data&#x2F;docker&#x2F;var&#x2F;run&#x2F;docker.sock:&#x2F;var&#x2F;run&#x2F;docker.sock \</span><br><span class="line">  jenkinsci&#x2F;blueocean</span><br></pre></td></tr></table></figure>

<p>Jenkins默认用户不是root，所以连接github时需要再生成key：</p>
<p>进入jenkins容器后，执行命令：<code>ssh-keygen -t rsa -C &quot;jenkins@git&quot;</code>,<code>cd ~/.ssh</code>.</p>
<p><code>docker cp a2119a11fbfa:/root/.ssh/id_rsa.pub /jacky/data/temp</code></p>
<p>另外一种方法，在jenkins容器内执行命令：<code>git ls-remote -h git@github.com:cloris-cc/demo.git HEAD</code></p>
<h3 id="jenkins-插件下载速度慢"><a href="#jenkins-插件下载速度慢" class="headerlink" title="jenkins 插件下载速度慢"></a>jenkins 插件下载速度慢</h3><p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/Y0in7t.png" alt="Y0in7t"></p>
<p>这个也可以：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></p>
<p><a target="_blank" rel="noopener" href="http://mirror.xmission.com/jenkins/updates/current/update-center.json">http://mirror.xmission.com/jenkins/updates/current/update-center.json</a></p>
<p><a target="_blank" rel="noopener" href="http://mirror.esuni.jp/jenkins/updates/update-center.json">http://mirror.esuni.jp/jenkins/updates/update-center.json</a></p>
<h1 id="Docker-配置"><a href="#Docker-配置" class="headerlink" title="Docker 配置"></a>Docker 配置</h1><h2 id="daemon-json"><a href="#daemon-json" class="headerlink" title="daemon.json"></a>daemon.json</h2><p><code>[root@libresse-test01 ~]# cat /etc/docker/daemon.json</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="attr">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://ndy7ld6k.mirror.aliyuncs.com&quot;</span>,<span class="string">&quot;http://abcd1234.m.daocloud.io&quot;</span>],</span><br><span class="line"> <span class="attr">&quot;graph&quot;</span>: <span class="string">&quot;/guanke/datas/docker&quot;</span>,    </span><br><span class="line"> <span class="attr">&quot;dns&quot;</span>: [<span class="string">&quot;8.8.8.8&quot;</span>,<span class="string">&quot;8.8.4.4&quot;</span>],</span><br><span class="line"> <span class="attr">&quot;hosts&quot;</span>: [<span class="string">&quot;tcp://0.0.0.0:2378&quot;</span>,<span class="string">&quot;unix:///var/run/docker.sock&quot;</span>],</span><br><span class="line"> <span class="attr">&quot;log-driver&quot;</span>:<span class="string">&quot;json-file&quot;</span>,</span><br><span class="line"> <span class="attr">&quot;log-opts&quot;</span>:&#123;</span><br><span class="line">    <span class="attr">&quot;max-size&quot;</span> :<span class="string">&quot;500m&quot;</span>,<span class="attr">&quot;max-file&quot;</span>:<span class="string">&quot;3&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="修改-daemon-json-后"><a href="#修改-daemon-json-后" class="headerlink" title="修改 daemon.json 后"></a>修改 daemon.json 后</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a.修改完成后reload配置文件</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line"></span><br><span class="line">b.重启docker服务</span><br><span class="line">sudo systemctl restart docker.service</span><br><span class="line"></span><br><span class="line">c.查看状态</span><br><span class="line">sudo systemctl status docker -l</span><br><span class="line"></span><br><span class="line">d.查看服务</span><br><span class="line">sudo docker info</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reloadsudo systemctl restart docker</span><br></pre></td></tr></table></figure>

<h2 id="远程访问"><a href="#远程访问" class="headerlink" title="远程访问"></a>远程访问</h2><p><a target="_blank" rel="noopener" href="https://docs.docker.com/install/linux/linux-postinstall/#configure-where-the-docker-daemon-listens-for-connections">见 Docker 官方文档</a></p>
<p>查看远程主机docker信息命令: <code>docker -H tcp://ip-address:port info</code><br>例如，<code>docker -H tcp://10.100.240.124:2378 info</code></p>
<h3 id="Configuring-remote-access-with-systemd-unit-file"><a href="#Configuring-remote-access-with-systemd-unit-file" class="headerlink" title="Configuring remote access with systemd unit file"></a>Configuring remote access with <code>systemd</code> unit file<a target="_blank" rel="noopener" href="https://docs.docker.com/install/linux/linux-postinstall/#configuring-remote-access-with-systemd-unit-file"></a></h3><ol>
<li><p>Use the command <code>sudo systemctl edit docker.service</code> to open an override file for <code>docker.service</code> in a text editor.</p>
</li>
<li><p>Add or modify the following lines, substituting your own values.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Service]ExecStart&#x3D;ExecStart&#x3D;&#x2F;usr&#x2F;bin&#x2F;dockerd -H fd:&#x2F;&#x2F; -H tcp:&#x2F;&#x2F;127.0.0.1:2375</span><br></pre></td></tr></table></figure>
</li>
<li><p>Save the file.</p>
</li>
<li><p>Reload the <code>systemctl</code> configuration.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure>
</li>
<li><p>Restart Docker.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart docker.service</span><br></pre></td></tr></table></figure>
</li>
<li><p>Check to see whether the change was honored by reviewing the output of <code>netstat</code> to confirm <code>dockerd</code> is listening on the configured port.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo netstat -lntp | grep dockerdtcp        0      0 127.0.0.1:2375          0.0.0.0:*               LISTEN      3758&#x2F;dockerd</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="镜像加速"><a href="#镜像加速" class="headerlink" title="镜像加速"></a>镜像加速</h2><p>编辑<code>/etc/docker/daemon.json</code>,添加 registry-mirrors：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;registry-mirrors&quot;: [      &quot;https:&#x2F;&#x2F;registry.docker-cn.com&quot;],  &quot;insecure-registries&quot;: [],  &quot;debug&quot;: true,  &quot;experimental&quot;: false&#125;</span><br></pre></td></tr></table></figure>

<h2 id="挂载目录-卷"><a href="#挂载目录-卷" class="headerlink" title="挂载目录/卷"></a>挂载目录/卷</h2><p>目录均可自定义。如挂载<code>自定义主机目录:/自定义容器目录</code>。<br>存放日志时，需要在主机上为各个微服务建立单独的日志存放目录/路径，避免存放在一起，使各个容器体积变大。</p>
<h2 id="修改已启动容器时区"><a href="#修改已启动容器时区" class="headerlink" title="修改已启动容器时区"></a>修改已启动容器时区</h2><ol>
<li><code>echo &quot;Asia/Shanghai&quot; &gt; /etc/timezone</code></li>
<li><code>dpkg-reconfigure -f noninteractive tzdata</code></li>
<li>使用 docker cp 命令：<code>docker cp /etc/localtime [容器ID或者NAME]:/etc/localtime</code></li>
</ol>
<h1 id="项目应用"><a href="#项目应用" class="headerlink" title="项目应用"></a>项目应用</h1><h2 id="打包-Dockerfile"><a href="#打包-Dockerfile" class="headerlink" title="打包 Dockerfile"></a>打包 Dockerfile</h2><p>tag：将resources目录一同打包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span>            <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span>            <span class="tag">&lt;<span class="name">resource</span>&gt;</span>                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span>                <span class="tag">&lt;<span class="name">includes</span>&gt;</span>                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*<span class="tag">&lt;/<span class="name">include</span>&gt;</span>                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span>            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span>            <span class="tag">&lt;<span class="name">resource</span>&gt;</span>                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/docker<span class="tag">&lt;/<span class="name">directory</span>&gt;</span>                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span>                <span class="tag">&lt;<span class="name">includes</span>&gt;</span>                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/Dockerfile<span class="tag">&lt;/<span class="name">include</span>&gt;</span>                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span>                <span class="tag">&lt;<span class="name">targetPath</span>&gt;</span>$&#123;project.build.directory&#125;<span class="tag">&lt;/<span class="name">targetPath</span>&gt;</span>            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span>        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="TEA-Dockerfile"><a href="#TEA-Dockerfile" class="headerlink" title="TEA Dockerfile"></a>TEA Dockerfile</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">FROM</span> <span class="string">openjdk:8MAINTAINER</span> <span class="string">jakcy</span> <span class="string">&quot;jacky.teamwang@qq.com&quot;</span><span class="string">ENV</span> <span class="string">TZ=&quot;Asia/Shanghai&quot;VOLUME</span> <span class="string">/tmpADD</span> <span class="string">tea-tea.jar</span> <span class="string">app.jar#</span> <span class="string">docker</span> <span class="string">hints</span> <span class="string">server</span> <span class="string">portEXPOSE</span> <span class="string">8080ENTRYPOINT</span> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;app.jar&quot;</span>]</span><br></pre></td></tr></table></figure>

<h2 id="Jenkins-项目配置"><a href="#Jenkins-项目配置" class="headerlink" title="Jenkins 项目配置"></a>Jenkins 项目配置</h2><p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/JXW8MC.png" alt="JXW8MC"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image rm github-demo-imgdocker build -t github-demo-img &#x2F;jacky&#x2F;data&#x2F;docker&#x2F;image&#x2F;sleep 1docker psdocker stop github-demodocker run -d -p 8083:8083 -e TZ&#x3D;&quot;Asia&#x2F;Shanghai&quot; -v &#x2F;jacky&#x2F;data&#x2F;docker&#x2F;tmp:&#x2F;tmp --rm --name github-demo github-demo-img ## 仍需挂载日志目录和切换时区</span><br></pre></td></tr></table></figure>

<h2 id="清除docker日志"><a href="#清除docker日志" class="headerlink" title="清除docker日志"></a>清除docker日志</h2><p>du -chs /tea/docker/containers/*/*json.log</p>
<h2 id="docker-清理命令"><a href="#docker-清理命令" class="headerlink" title="docker 清理命令"></a>docker 清理命令</h2><p><code>docker system prune</code></p>
<h2 id="找出大文件命令"><a href="#找出大文件命令" class="headerlink" title="找出大文件命令"></a>找出大文件命令</h2><p>找出大文件命令：<code>find . -type f -size +40M  -print0 | xargs -0 du -h | sort -nr</code></p>
<h2 id="启动-nginx"><a href="#启动-nginx" class="headerlink" title="启动 nginx"></a>启动 nginx</h2><p>nginx.conf 文件示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user  nginx;worker_processes  1;error_log  &#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log warn;pid        &#x2F;var&#x2F;run&#x2F;nginx.pid;events &#123;    worker_connections  1024;&#125;http &#123;    include       &#x2F;etc&#x2F;nginx&#x2F;mime.types;    default_type  application&#x2F;octet-stream;    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;    access_log  &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log  main;    sendfile        on;    #tcp_nopush     on;    keepalive_timeout  65;    #gzip  on;    include &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;*.conf;    server &#123;        listen 80;        server_name www.teamwang.cn teamwang.cn;        rewrite ^(.*) https:&#x2F;&#x2F;$server_name$1 permanent;    &#125;    server &#123;        listen 18005;        server_name www.teamwang.cn teamwang.cn;        location &#x2F;static &#123;            alias &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;static;            expires 1d;            autoindex on;        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中，<code>*.conf</code>默认有<code>default.conf</code>：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server &#123;    listen       80;    listen  [::]:80;    server_name  localhost;    #charset koi8-r;    #access_log  &#x2F;var&#x2F;log&#x2F;nginx&#x2F;host.access.log  main;    location &#x2F; &#123;        root   &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;        index  index.html index.htm;    &#125;    #error_page  404              &#x2F;404.html;    # redirect server error pages to the static page &#x2F;50x.html    #    error_page   500 502 503 504  &#x2F;50x.html;    location &#x3D; &#x2F;50x.html &#123;        root   &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;    &#125;    # proxy the PHP scripts to Apache listening on 127.0.0.1:80    #    #location ~ \.php$ &#123;    #    proxy_pass   http:&#x2F;&#x2F;127.0.0.1;    #&#125;    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000    #    #location ~ \.php$ &#123;    #    root           html;    #    fastcgi_pass   127.0.0.1:9000;    #    fastcgi_index  index.php;    #    fastcgi_param  SCRIPT_FILENAME  &#x2F;scripts$fastcgi_script_name;    #    include        fastcgi_params;    #&#125;    # deny access to .htaccess files, if Apache&#39;s document root    # concurs with nginx&#39;s one    #    #location ~ &#x2F;\.ht &#123;    #    deny  all;    #&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/bz4T6c.png" alt="bz4T6c"></p>
<p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/Kxzur3.png" alt="Kxzur3"></p>
<h2 id="修改容器配置"><a href="#修改容器配置" class="headerlink" title="修改容器配置"></a>修改容器配置</h2><blockquote>
<p>参照该项目：<a target="_blank" rel="noopener" href="https://github.com/nacos-group/nacos-docker">https://github.com/nacos-group/nacos-docker</a><br>其中的 docker-compose.yml 的 env 环境变量以文件方式提取，</p>
</blockquote>
<p>如果要自定义容器的配置，建议使用 <code>docker-compose up</code> 命令。相应的配置在 xxx.yml 中修改即可，使用 <code>docker-compose -f xxx.yml up</code>。-f 是 -file 的意思。</p>
<p>下面是 nacos-docker 其中一个启动配置文件 <strong>standalone-mysql-5.7.yaml</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;2&quot;</span><span class="attr">services:  nacos:    image: nacos/nacos-server:latest    container_name:</span> <span class="string">nacos-standalone-mysql</span>    <span class="comment"># 用文件方式读取 env    env_file:      - ../env/nacos-standlone-mysql.env    volumes:      - ./standalone-logs/:/home/nacos/logs      - ./init.d/custom.properties:/home/nacos/init.d/custom.properties    ports:      - &quot;8848:8848&quot;      - &quot;9555:9555&quot;    depends_on:      - mysql    restart: on-failure  mysql:    container_name: mysql    image: nacos/nacos-mysql:5.7    env_file:      - ../env/mysql.env    volumes:      - ./mysql:/var/lib/mysql    ports:      - &quot;3306:3306&quot;  prometheus:    container_name: prometheus    image: prom/prometheus:latest    volumes:      - ./prometheus/prometheus-standalone.yaml:/etc/prometheus/prometheus.yml    ports:      - &quot;9090:9090&quot;    depends_on:      - nacos    restart: on-failure  grafana:    container_name: grafana    image: grafana/grafana:latest    ports:      - 3000:3000    restart: on-failure</span></span><br></pre></td></tr></table></figure>

<h2 id="查看容器ip-address"><a href="#查看容器ip-address" class="headerlink" title="查看容器ip address"></a>查看容器ip address</h2><p>命令：<code>docker inspect container_id</code></p>
<p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/LHQjDu.png" alt="LHQjDu"></p>
<p><strong>Gateway是本机！替代localhost!</strong></p>
<h1 id="docker-进阶"><a href="#docker-进阶" class="headerlink" title="docker 进阶"></a>docker 进阶</h1><h2 id="1-服务编排"><a href="#1-服务编排" class="headerlink" title="1. 服务编排"></a>1. 服务编排</h2><h3 id="1-1-Mesos"><a href="#1-1-Mesos" class="headerlink" title="1.1 Mesos"></a>1.1 Mesos</h3><h3 id="1-2-DockerSwarm"><a href="#1-2-DockerSwarm" class="headerlink" title="1.2 DockerSwarm"></a>1.2 DockerSwarm</h3><blockquote>
<p>教程：<br><a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/docker-swarm-guides/kai-shi-shi-yong-swarm-swarmmo-shi-duan-kou-lu-you.md">https://www.bookstack.cn/read/docker-swarm-guides/kai-shi-shi-yong-swarm-swarmmo-shi-duan-kou-lu-you.md</a></p>
</blockquote>
<h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/E2d7qr.png" alt="E2d7qr"></p>
<p>服务发现机制：</p>
<ul>
<li>Ingress：overlay 网络</li>
</ul>
<h4 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h4><blockquote>
<p>Attention:</p>
</blockquote>
<ul>
<li>开放 manager 主机TCP <strong>2377</strong>端口(也可以自定义)</li>
<li>开放所有节点的 TCP/UDP <strong>7946</strong>端口用于container服务发现</li>
<li>UDP <strong>4789</strong>端口用于overlay网络通信。</li>
</ul>
<ol>
<li>初始化集群(Manager * 1)<br><code>docker swarm init --advertise-addr &lt;MANAGER-IP&gt;:&lt;PORT&gt;</code></li>
</ol>
<p><img src="https://gitee.com/jacky_cloud/oss/raw/master/uPic/KjIZEB.png" alt="KjIZEB"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker swarm join --token SWMTKN-1-28bihq1uqncv0whwd5laj01kmgdx32oqp1crkzopn80087tvl8-aokefgdf485ju7cj85zk9qapn 47.94.128.66:2377</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>加入工作节点(Node * n)<br><code>docker swarm join --token &lt;TOKEN&gt; &lt;MANAGER-IP&gt;:&lt;PORT&gt;</code></p>
</li>
<li><p>疏散当前节点<br><code>docker swarm leave</code></p>
</li>
<li><p>提升worker为manager<br><code>docker node ls</code><br><code>docker node promote [hostname]</code></p>
</li>
</ol>
<h4 id="常用命令-1"><a href="#常用命令-1" class="headerlink" title="常用命令"></a>常用命令</h4><p>创建自定义网络： <code>docker network create --driver=overlay --attachable mynet</code></p>
<p>发布服务：<code>docker service create --replicas 1  --name helloworld alpine ping docker.com</code><br>服务更新：<code>docker service update</code><br>服务伸缩：<code>docker service scale &lt;SERVICE-ID&gt;=&lt;NUMBER-OF-TASKS&gt;</code><br>服务列表：<code>docker service list</code><br>查看服务状态：<code>docker [service] inspect --pretty &lt;Service-Id&gt;</code><br>查看服务所在节点：<code>docker service ps nginx-all</code><br>删除：<code>docker service rm [service-id/name]</code><br>端口映射：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker service create \  --name &lt;SERVICE-NAME&gt; \  --publish published&#x3D;&lt;xx&gt;,target&#x3D;&lt;xx&gt; \  [--publish-add &lt;xx&gt;:&lt;xx&gt;]  &lt;IMAGE&gt;</span><br></pre></td></tr></table></figure>

<p>更新端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker service update \  --publish-add published&#x3D;&lt;PUBLISHED-PORT&gt;,target&#x3D;&lt;CONTAINER-PORT&gt; \  &lt;SERVICE&gt;</span><br></pre></td></tr></table></figure>


<h3 id="1-3-Kubernetes"><a href="#1-3-Kubernetes" class="headerlink" title="1.3 Kubernetes"></a>1.3 Kubernetes</h3></div><div class="article-licensing box"><div class="licensing-title"><p>docker</p><p><a href="https://teamwang.cn/2021/10/29/docker/">https://teamwang.cn/2021/10/29/docker/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Jacky</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-10-29</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-11-03</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/10/29/ServiceMesh-Serverless-K8s/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">ServiceMesh, Serverless, K8s</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/10/29/%E8%BF%88%E5%90%91%E9%AB%98%E7%BA%A7Java%E7%9A%84%E9%9D%A2%E8%AF%95%E7%AA%81%E5%9B%B4%E8%AF%BE/"><span class="level-item">迈向高级Java的面试突围课</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "D7nrmJ3xSHla6mxR3p0BrXqD-gzGzoHsz",
            appKey: "rGXO6glIn8ETvzytN7maFaoP",
            placeholder: "Leave your comments~",
            
            
            meta: ["nick"],
            pageSize: 10,
            lang: "en",
            visitor: true,
            highlight: true,
            
            
            
            
            enableQQ: true,
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Docker"><span class="level-left"><span class="level-item">Docker</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#常用命令"><span class="level-left"><span class="level-item">常用命令</span></span></a></li><li><a class="level is-mobile" href="#命令的使用"><span class="level-left"><span class="level-item">命令的使用</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#run-新容器"><span class="level-left"><span class="level-item">run 新容器</span></span></a></li><li><a class="level is-mobile" href="#打开mysql-client命令行"><span class="level-left"><span class="level-item">打开mysql client命令行</span></span></a></li><li><a class="level is-mobile" href="#查看容器信息"><span class="level-left"><span class="level-item">查看容器信息</span></span></a></li><li><a class="level is-mobile" href="#进入容器路径"><span class="level-left"><span class="level-item">进入容器路径</span></span></a></li><li><a class="level is-mobile" href="#路径映射"><span class="level-left"><span class="level-item">路径映射</span></span></a></li><li><a class="level is-mobile" href="#build-构建镜像"><span class="level-left"><span class="level-item">build 构建镜像</span></span></a></li><li><a class="level is-mobile" href="#删除-docker"><span class="level-left"><span class="level-item">删除 docker</span></span></a></li><li><a class="level is-mobile" href="#查看镜像信息"><span class="level-left"><span class="level-item">查看镜像信息</span></span></a></li><li><a class="level is-mobile" href="#容器间的网络通信"><span class="level-left"><span class="level-item">容器间的网络通信</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Docker-构建-SpringBoot-应用"><span class="level-left"><span class="level-item">Docker 构建 SpringBoot 应用</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#基础"><span class="level-left"><span class="level-item">基础</span></span></a></li><li><a class="level is-mobile" href="#docker-compose-构建运行"><span class="level-left"><span class="level-item">docker-compose 构建运行</span></span></a></li></ul></li><li><a class="level is-mobile" href="#注意事项"><span class="level-left"><span class="level-item">注意事项</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Jenkins"><span class="level-left"><span class="level-item">Jenkins</span></span></a><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#jenkins-插件下载速度慢"><span class="level-left"><span class="level-item">jenkins 插件下载速度慢</span></span></a></li></ul></ul></li><li><a class="level is-mobile" href="#Docker-配置"><span class="level-left"><span class="level-item">Docker 配置</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#daemon-json"><span class="level-left"><span class="level-item">daemon.json</span></span></a></li><li><a class="level is-mobile" href="#修改-daemon-json-后"><span class="level-left"><span class="level-item">修改 daemon.json 后</span></span></a></li><li><a class="level is-mobile" href="#远程访问"><span class="level-left"><span class="level-item">远程访问</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Configuring-remote-access-with-systemd-unit-file"><span class="level-left"><span class="level-item">Configuring remote access with systemd unit file</span></span></a></li></ul></li><li><a class="level is-mobile" href="#镜像加速"><span class="level-left"><span class="level-item">镜像加速</span></span></a></li><li><a class="level is-mobile" href="#挂载目录-卷"><span class="level-left"><span class="level-item">挂载目录/卷</span></span></a></li><li><a class="level is-mobile" href="#修改已启动容器时区"><span class="level-left"><span class="level-item">修改已启动容器时区</span></span></a></li></ul></li><li><a class="level is-mobile" href="#项目应用"><span class="level-left"><span class="level-item">项目应用</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#打包-Dockerfile"><span class="level-left"><span class="level-item">打包 Dockerfile</span></span></a></li><li><a class="level is-mobile" href="#TEA-Dockerfile"><span class="level-left"><span class="level-item">TEA Dockerfile</span></span></a></li><li><a class="level is-mobile" href="#Jenkins-项目配置"><span class="level-left"><span class="level-item">Jenkins 项目配置</span></span></a></li><li><a class="level is-mobile" href="#清除docker日志"><span class="level-left"><span class="level-item">清除docker日志</span></span></a></li><li><a class="level is-mobile" href="#docker-清理命令"><span class="level-left"><span class="level-item">docker 清理命令</span></span></a></li><li><a class="level is-mobile" href="#找出大文件命令"><span class="level-left"><span class="level-item">找出大文件命令</span></span></a></li><li><a class="level is-mobile" href="#启动-nginx"><span class="level-left"><span class="level-item">启动 nginx</span></span></a></li><li><a class="level is-mobile" href="#修改容器配置"><span class="level-left"><span class="level-item">修改容器配置</span></span></a></li><li><a class="level is-mobile" href="#查看容器ip-address"><span class="level-left"><span class="level-item">查看容器ip address</span></span></a></li></ul></li><li><a class="level is-mobile" href="#docker-进阶"><span class="level-left"><span class="level-item">docker 进阶</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-服务编排"><span class="level-left"><span class="level-item">1. 服务编排</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-Mesos"><span class="level-left"><span class="level-item">1.1 Mesos</span></span></a></li><li><a class="level is-mobile" href="#1-2-DockerSwarm"><span class="level-left"><span class="level-item">1.2 DockerSwarm</span></span></a></li><li><a class="level is-mobile" href="#1-3-Kubernetes"><span class="level-left"><span class="level-item">1.3 Kubernetes</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Jacky"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Jacky</p><p class="is-size-6 is-block">(ง ˙o˙)ว</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">36</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/cloris-cc"><i class="fab fa-github"></i></a></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><p class="is-size-7"><span>&copy; 2021 Jacky</span>  <a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备19098392号</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/"><i class="fab fa-weibo"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/cloris-cc"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>